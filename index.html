<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

    <!-- Security: Content Security Policy (Strict) -->
    <!-- Allow cdnjs, self; Disallow object/frame injection -->
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; img-src 'self' data:; object-src 'none'; base-uri 'self'; frame-ancestors 'none';">

    <!-- Performance: Preconnect to CDN -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <title>人生超市 - 會員卡生成器 (照片調整增強版)</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/croppie/2.6.5/croppie.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="app-sandbox">
        <div class="layer-visual">
            <img src="Vector 1.png" class="top-green-banner">
            <img src="謝謝光臨橫幅.png" class="thanks-banner">
            <img src="請支援收銀.png" class="cashier-sticker">
            <img src="大標題.png" class="main-title-img">
            <img src="會員卡.png" class="membership-card-bg">
            <!-- New: Final Result Display -->
            <img id="final-result-display"
                style="display: none; position: absolute; z-index: 100; top: 44%; left: 50.75%; transform: translateX(-50%); width: 85%; pointer-events: auto;"
                alt="您的會員卡">

            <img src="離職集點卡.png" class="resignation-card">
            <img src="交易明細.png" class="receipt-paper">
            <img src="熱賣商品.png" class="hot-item-tag">
            <img src="特價中2025.png" class="sale-2025-sticker">
            <img src="開始結帳.png" class="checkout-btn" id="btn-checkout">
        </div>
        <div class="layer-interactive">
            <input type="file" id="file-input" accept="image/*" style="display: none;">
            <!-- Controls moved to Modal -->
        </div>

        <div class="layer-overlay">
            <div class="marquee-banner" style="top: 0;">
                <div class="marquee-content"><span>SALE • SALE • SALE • SALE • SALE • SALE • </span><span>SALE • SALE •
                        SALE • SALE • SALE • SALE • </span></div>
            </div>
            <div class="marquee-banner" style="bottom: 0;">
                <div class="marquee-content"><span>SALE • SALE • SALE • SALE • SALE • SALE • </span><span>SALE • SALE •
                        SALE • SALE • SALE • SALE • </span></div>
            </div>
        </div>
    </div>

    <!-- New: Edit Modal -->
    <div id="edit-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 style="color: white; margin-bottom: 20px; font-weight: 900; letter-spacing: 1px;">客製您的會員卡</h3>

            <div class="upload-container modal-upload-style">
                <div class="upload-zone" id="upload-zone">
                    <span class="upload-tip" id="upload-text">上傳照片</span>
                    <div id="cropper-container"></div>
                </div>
            </div>

            <div class="name-input-container modal-input-style">
                <span class="name-label" style="color: white;">會員姓名：</span>
                <input type="text" id="member-name" class="name-field"
                    style="color: white; border-bottom: 1px solid white;">
            </div>

            <div class="modal-actions" style="margin-top: 30px; display: flex; gap: 20px;">
                <button id="btn-cancel" class="action-btn cancel">取消</button>
                <button id="btn-confirm" class="action-btn confirm">確認製作</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/croppie/2.6.5/croppie.min.js"></script>
    <script src="script.js"></script>
</body>

</html>
